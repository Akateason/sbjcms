<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>内容列表</title>
</head>
<body>
<div class="searchInfoContainer">
    <select name="searchType" id="searchType">
        <option value="1">标题</option>
        <option value="2">标签</option>
    </select>
    <input type="text" name="searchIpt" id="searchIpt">
    <a href="javascript:searchData();" id="searchBtn">Search</a>
</div>
<a href="/content/addH">添加新内容</a>
<table id="contetListContainer">

</table>
<a href="/content/addH">添加新内容</a>

<script src="${ctx}/scripts/jquery-1.8.3.min.js"></script>
<script src="${ctx}/scripts/react.js"></script>
<script src="${ctx}/scripts/JSXTransformer.js"></script>

<script type="text/jsx">
    var MyList=React.createClass({
        render:function(){
            var flist=this.props.data.map(function(content){
                var modifyLink="content/addH?contentId="+content.contentId;
                var delLink="content/del?contentId="+content.contentId;
                return(
                        <tr>
                            <td>{content.title}</td>
                            <td>{content.kind}</td>
                            <td><a href={modifyLink}>修改</a> <a href={delLink}>删除</a></td>
                        </tr>
                )
            })
            return(
                    <tbody>
                        {flist}
                    </tbody>
            )
        }
    })
    var myCompent;
    function getData() {
        $.ajax("/content/list",{
            success:function(data){
                console.log(data);
                myCompent=React.render(
                        React.createElement(MyList,{"data":data.returnData.list}),
                        document.getElementById("contetListContainer")
                )
            }
        })
    }
    function searchData(){
        var searchType=$("#searchType").val()=="1"?"searchByTitle":"searchByTag";
        var searchIpt=$("#searchIpt").val();
        if(searchIpt.length==0){
            alert("搜索内容不能为空");
            return false;
        }
        $.ajax("/content/"+searchType,{
            data:{keyword:searchIpt},
            success:function(data){
                myCompent.setProps({"data":data.returnData.list});
            }
        })
    }
    getData();
</script>
</body>
</html>